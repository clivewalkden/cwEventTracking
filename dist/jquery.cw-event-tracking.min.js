/*!
* cw-event-tracking - for jQuery 1.7+
* https://github.com/clivewalkden/cw-event-tracking
*
* Copyright 2015, Clive Walkden (http://clivewalkden.co.uk)
*
* @package CW Event Tracking
* @author Clive Walkden (https://github.com/clivewalkden)
* @version 0.1.2
* @copyright Copyright (c) 2015 Clive Walkden (https://github.com/clivewalkden)
* @date: 2015-03-18
*/

!function(a){a.fn.CWEventTracking=function(b){var c={filetypes:/\.(zip|exe|pdf|doc*|xls*|ppt*|mp3)$/i,mailtypes:/^(mailto|gospam)\:/i,teltypes:/^tel\:/i,baseHref:"",debug:!1,active:!1,isActive:function(){},isInactive:function(){},isClicked:function(){}},d=a.extend({},c,b),e={analyticsCheck:function(){e.debug("Check Analytics is loaded."),"undefined"==typeof _gaq?(e.debug("Analytics is not running"),d.isInactive.call(a(this))):(d.isActive.call(a(this)),d.active=!0)},handleExternal:function(b){var c=b.replace(/^https?\:\/\//i,"");return e.track("External","Click",c),void 0!==a(this).attr("target")&&"_blank"!==a(this).attr("target").toLowerCase()?(setTimeout(function(){location.href=b},200),!1):void 0},handleMail:function(a){var b=a.replace(d.mailtypes,"");a.match(/^gospam\:/i)&&(b=b.split("").reverse().join("")),e.track("Email","Click",b)},handleTelephone:function(a){var b=a.replace(d.teltypes,"");e.track("Telephone","Click",b)},handleFile:function(b){var c=/[.]/.exec(b)?/[^.]+$/.exec(b):void 0,f=b;return e.track("Download","Click-"+c,f),void 0!==a(this).attr("target")&&"_blank"!==a(this).attr("target").toLowerCase()?(setTimeout(function(){location.href=d.baseHref+b},200),!1):void 0},track:function(a,b,c){_gaq.push(["_trackEvent",a,b,c])},debug:function(a){d.debug&&"undefined"!=typeof console&&"undefined"!=typeof console.debug&&console.debug(a)}};return e.analyticsCheck(),this.each(function(){if(!d.active)return!1;var b=a(this).attr("href");b&&b.match(/^https?\:/i)&&!b.match(document.domain)?a(this).on("click",function(){d.isClicked.call(a(this)),e.debug("External Link clicked."),e.handleExternal(b)}):b&&b.match(d.mailtypes)?a(this).on("click",function(){d.isClicked.call(a(this)),e.debug("Email Link clicked."),e.handleMail(b)}):b&&b.match(d.teltypes)?(a(this).attr("href",b.replace(" ","")),a(this).on("click",function(){d.isClicked.call(a(this)),e.debug("Telephone Link clicked."),e.handleTelephone(b)})):b&&b.match(d.filetypes)&&a(this).on("click",function(){d.isClicked.call(a(this)),e.debug("File Link clicked."),e.handleFile(b)})})}}(jQuery);